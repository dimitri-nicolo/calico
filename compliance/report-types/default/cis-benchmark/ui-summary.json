{{ $n := len .CISBenchmark }}
{
	"heading": "Kubernetes CIS Benchmark",
	"type": "row",
	"widgets": [{
		"heading": "Node Failure Summary",
		"type": "cis-benchmark-nodes",
		"summary": {
			"label": "Total",
			"total": {{ $n }}
		},
		"data": [{
			"label": "HIGH",
			"value": {{ .CISBenchmarkSummary.HighCount }},
			"desc": "Nodes with {{ if .ReportSpec.CIS }}{{ if .ReportSpec.CIS.HighThreshold }}{{ if eq (int .ReportSpec.CIS.HighThreshold) 100 }}100%{{ else }}{{ .ReportSpec.CIS.HighThreshold }}% or more{{ end }}{{ else }}100%{{ end }}{{ else }}100%{{ end }} tests passing"
		}, {
			"label": "MED",
			"value": {{ .CISBenchmarkSummary.MedCount }},
			"desc": "Nodes with {{ if .ReportSpec.CIS }}{{ if .ReportSpec.CIS.MedThreshold }}{{ .ReportSpec.CIS.MedThreshold }}{{ else }}50{{ end }}{{ else }}50{{ end }}% or more tests passing"
		}, {
			"label": "LOW",
			"value": {{ .CISBenchmarkSummary.LowCount }},
			"desc": "Nodes with less than {{ if .ReportSpec.CIS }}{{ if .ReportSpec.CIS.MedThreshold }}{{ .ReportSpec.CIS.MedThreshold }}{{ else }}50{{ end }}{{ else }}50{{ end }}% tests passing"
		}]
	}
{{ if .CISBenchmark }}
	, {
		"heading": "Top Failed Tests",
		"type": "cis-benchmark-tests",
		"topFailedTests": {
			"tests": [
{{ $tests := cisTopFailedTests . }}
{{ $nTests := len $tests }}
{{ range $i, $test := $tests }}
			{
				"index": "{{ $test.TestNumber }}",
				"description": "{{ $test.TestDesc }}",
				"failedCount": "{{ $test.Count }}"
			} {{ $i1 := add1 $i }}{{ if ne $i1 $nTests }}, {{ end }}
{{ end }}
			]} 
	}
{{ end }}
	]
}
