{
  "job_id": "$CLUSTER_NAME.port_scan_pods",
  "job_type": "$CLUSTER_NAME.anomaly_detector",
  "job_version": "6.4.3",
  "groups": [
    "recon"
  ],
  "description": "Port Scan - Pods",
  "analysis_config": {
    "bucket_span": "10m",
    "detectors": [
      {
        "detector_description": "Count of destination ports compared with all pods",
        "function": "high_distinct_count",
        "field_name": "dest_port",
        "over_field_name": "source_name",
        "detector_index": 0
      },
      {
        "detector_description": "Count of destination ports compared with replica set",
        "function": "high_distinct_count",
        "field_name": "dest_port",
        "over_field_name": "source_name",
        "partition_field_name": "namespace_source_name_aggr",
        "detector_index": 1
      }
    ],
    "influencers": [
      "source_name",
      "source_name_aggr",
      "source_namespace"
    ]
  },
  "analysis_limits": {
    "model_memory_limit": "1024mb",
    "categorization_examples_limit": 4
  },
  "data_description": {
    "time_field": "start_time",
    "time_format": "epoch_ms"
  },
  "model_snapshot_retention_days": 1,
  "custom_settings": {
    "created_by": "population-wizard"
  },
  "results_index_name": "port_scan_pods.$CLUSTER_NAME"
}
