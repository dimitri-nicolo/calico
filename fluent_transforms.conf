<filter flows>
  @type record_transformer
  <record>
    host "#{Socket.gethostname}"
  </record>
</filter>

<filter dns>
  @type record_transformer
  <record>
    host "#{Socket.gethostname}"
  </record>
</filter>

<filter audit.*>
  @type record_transformer
  enable_ruby
  <record>
    # Create a name field from the objectRef.name, responseObject.metadata.name or responseObject.details.name
    name ${record["responseObject"].nil? ? (record["objectRef"].nil? ? "-" : record["objectRef"]["name"]) :	(record["responseObject"]["metadata"].nil? ? record["responseObject"]["details"]["name"] : record["responseObject"]["metadata"]["name"])}
  </record>
</filter>
