<filter flows>
  @type record_transformer
  enable_ruby
  <record>
    host "#{ENV['NODENAME']}"
  </record>
  <record>
    @timestamp ${record['end_time'] * 1000}
  </record>
</filter>

<filter dns>
  @type record_transformer
  <record>
    host "#{ENV['NODENAME']}"
  </record>
</filter>

<filter waf>
  @type record_transformer
  remove_keys level
  <record>
    host "#{ENV['NODENAME']}"
  </record>
</filter>

<filter l7>
  @type record_transformer
  <record>
    host "#{ENV['NODENAME']}"
  </record>
</filter>

<filter runtime>
  @type record_transformer
  <record>
    host "#{ENV['NODENAME']}"
  </record>
</filter>

<filter audit.*>
  @type record_transformer
  enable_ruby
  <record>
    # Create a name field from the objectRef.name, responseObject.metadata.name or responseObject.details.name
    name ${record["responseObject"].nil? ? (record["objectRef"].nil? ? "-" : record["objectRef"]["name"]) :	(record["responseObject"]["metadata"].nil? ? record["responseObject"]["details"]["name"] : record["responseObject"]["metadata"]["name"])}
  </record>
</filter>

<filter bird>
  @type record_transformer
  <record>
    host "#{ENV['NODENAME']}"
    ip_version "IPv4"
  </record>
</filter>

<filter bird6>
  @type record_transformer
  <record>
    host "#{ENV['NODENAME']}"
    ip_version "IPv6"
  </record>
</filter>

<filter bird bird6>
  @type grep
  <exclude>
    key message
    pattern /device1: Scanning interfaces/
  </exclude>
</filter>

