package replayer

var kubeAuditEventsJSONString = `{"took":18,"timed_out":false,"_shards":{"total":5,"successful":5,"skipped":0,"failed":0},"hits":{"total":{"relation":"eq","value":1},"max_score":2.3263016,"hits":[{"_index":"tigera_secure_ee_audit_kube.cluster.20190403","_type":"fluentd","_id":"5VfO5GkB5zWAjbhQ3FVa","_score":2.3263016,"_source":{"kind":"Event","apiVersion":"audit.k8s.io/v1","level":"RequestResponse","auditID":"9d68ec25-85d6-4d9d-b94f-ecdf0b70b816","stage":"ResponseComplete","requestURI":"/api/v1/namespaces/compliance-testing/pods/database-f5c74785f-m7vd2","verb":"delete","user":{"username":"system:serviceaccount:kube-system:generic-garbage-collector","uid":"9ef9bd97-54cb-11e9-8243-42010a800036","groups":["system:serviceaccounts","system:serviceaccounts:kube-system","system:authenticated"]},"sourceIPs":["10.128.0.54"],"userAgent":"kube-controller-manager/v1.13.4 (linux/amd64) kubernetes/c27b913/system:serviceaccount:kube-system:generic-garbage-collector","objectRef":{"resource":"pods","namespace":"compliance-testing","name":"database-f5c74785f-m7vd2","apiVersion":"v1"},"responseStatus":{"metadata":{},"code":200},"requestObject":{"kind":"DeleteOptions","apiVersion":"v1","preconditions":{"uid":"42f9fc99-564b-11e9-8550-42010a800036"},"propagationPolicy":"Background"},"responseObject":{"kind":"Pod","apiVersion":"v1","metadata":{"name":"database-f5c74785f-m7vd2","generateName":"database-f5c74785f-","namespace":"compliance-testing","selfLink":"/api/v1/namespaces/compliance-testing/pods/database-f5c74785f-m7vd2","uid":"42f9fc99-564b-11e9-8550-42010a800036","resourceVersion":"239827","creationTimestamp":"2019-04-03T20:01:25Z","deletionTimestamp":"2019-04-03T20:06:19Z","deletionGracePeriodSeconds":30,"labels":{"app":"database","pod-template-hash":"f5c74785f","version":"v1"},"ownerReferences":[{"apiVersion":"apps/v1","kind":"ReplicaSet","name":"database-f5c74785f","uid":"42f7023b-564b-11e9-8550-42010a800036","controller":true,"blockOwnerDeletion":true}]},"spec":{"volumes":[{"name":"database-token-fsjbn","secret":{"secretName":"database-token-fsjbn","defaultMode":420}}],"containers":[{"name":"database","image":"mysql","ports":[{"containerPort":3306,"protocol":"TCP"}],"resources":{},"volumeMounts":[{"name":"database-token-fsjbn","readOnly":true,"mountPath":"/var/run/secrets/kubernetes.io/serviceaccount"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"Always"}],"restartPolicy":"Always","terminationGracePeriodSeconds":30,"dnsPolicy":"ClusterFirst","serviceAccountName":"database","serviceAccount":"database","nodeName":"bkim-kadm-node-1","securityContext":{},"schedulerName":"default-scheduler","tolerations":[{"key":"node.kubernetes.io/not-ready","operator":"Exists","effect":"NoExecute","tolerationSeconds":300},{"key":"node.kubernetes.io/unreachable","operator":"Exists","effect":"NoExecute","tolerationSeconds":300}],"priority":0,"enableServiceLinks":true},"status":{"phase":"Running","conditions":[{"type":"Initialized","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-04-03T20:01:25Z"},{"type":"Ready","status":"False","lastProbeTime":null,"lastTransitionTime":"2019-04-03T20:03:03Z","reason":"ContainersNotReady","message":"containers with unready status: [database]"},{"type":"ContainersReady","status":"False","lastProbeTime":null,"lastTransitionTime":"2019-04-03T20:03:03Z","reason":"ContainersNotReady","message":"containers with unready status: [database]"},{"type":"PodScheduled","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-04-03T20:01:25Z"}],"hostIP":"10.128.0.133","podIP":"192.168.88.110","startTime":"2019-04-03T20:01:25Z","containerStatuses":[{"name":"database","state":{"waiting":{"reason":"CrashLoopBackOff","message":"Back-off 2m40s restarting failed container=database pod=database-f5c74785f-m7vd2_compliance-testing(42f9fc99-564b-11e9-8550-42010a800036)"}},"lastState":{"terminated":{"exitCode":1,"reason":"Error","startedAt":"2019-04-03T20:04:26Z","finishedAt":"2019-04-03T20:04:26Z","containerID":"docker://c2078bf0b3a77c344e2033291617ae548d315c8e34fc8c3591378c636127a40d"}},"ready":false,"restartCount":5,"image":"mysql:latest","imageID":"docker-pullable://mysql@sha256:a7cf659a764732a27963429a87eccc8457e6d4af0ee9d5140a3b56e74986eed7","containerID":"docker://c2078bf0b3a77c344e2033291617ae548d315c8e34fc8c3591378c636127a40d"}],"qosClass":"BestEffort"}},"requestReceivedTimestamp":"2019-04-03T20:05:49.801932Z","stageTimestamp":"2019-04-03T20:05:49.807571Z","annotations":{"authorization.k8s.io/decision":"allow","authorization.k8s.io/reason":"RBAC: allowed by ClusterRoleBinding \"system:controller:generic-garbage-collector\" of ClusterRole \"system:controller:generic-garbage-collector\" to ServiceAccount \"generic-garbage-collector/kube-system\""},"name":"database-f5c74785f-m7vd2"}},{"_index":"tigera_secure_ee_audit_kube.cluster.20190403","_type":"fluentd","_id":"7FfP5GkB5zWAjbhQBVU4","_score":2.3263016,"_source":{"kind":"Event","apiVersion":"audit.k8s.io/v1","level":"RequestResponse","auditID":"af9ceeaa-a4d3-45fd-b6a1-3f43f1a2c030","stage":"ResponseComplete","requestURI":"/api/v1/namespaces/compliance-testing/pods/database-74656f569f-kjbhl","verb":"delete","user":{"username":"system:node:bkim-kadm-ms","groups":["system:nodes","system:authenticated"]},"sourceIPs":["10.128.0.54"],"userAgent":"kubelet/v1.13.4 (linux/amd64) kubernetes/c27b913","objectRef":{"resource":"pods","namespace":"compliance-testing","name":"database-74656f569f-kjbhl","apiVersion":"v1"},"responseStatus":{"metadata":{},"code":200},"requestObject":{"kind":"DeleteOptions","apiVersion":"v1","gracePeriodSeconds":0,"preconditions":{"uid":"7bd389e8-564b-11e9-8550-42010a800036"}},"responseObject":{"kind":"Pod","apiVersion":"v1","metadata":{"name":"database-74656f569f-kjbhl","generateName":"database-74656f569f-","namespace":"compliance-testing","selfLink":"/api/v1/namespaces/compliance-testing/pods/database-74656f569f-kjbhl","uid":"7bd389e8-564b-11e9-8550-42010a800036","resourceVersion":"239854","creationTimestamp":"2019-04-03T20:03:01Z","deletionTimestamp":"2019-04-03T20:05:49Z","deletionGracePeriodSeconds":0,"labels":{"app":"database","pod-template-hash":"74656f569f","version":"v2"},"ownerReferences":[{"apiVersion":"apps/v1","kind":"ReplicaSet","name":"database-74656f569f","uid":"7bd0c8c0-564b-11e9-8550-42010a800036","controller":true,"blockOwnerDeletion":true}]},"spec":{"volumes":[{"name":"database-token-fsjbn","secret":{"secretName":"database-token-fsjbn","defaultMode":420}}],"containers":[{"name":"database","image":"mysql","ports":[{"containerPort":3307,"protocol":"TCP"}],"resources":{},"volumeMounts":[{"name":"database-token-fsjbn","readOnly":true,"mountPath":"/var/run/secrets/kubernetes.io/serviceaccount"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"Always"}],"restartPolicy":"Always","terminationGracePeriodSeconds":30,"dnsPolicy":"ClusterFirst","serviceAccountName":"database","serviceAccount":"database","nodeName":"bkim-kadm-ms","securityContext":{},"schedulerName":"default-scheduler","tolerations":[{"key":"node.kubernetes.io/not-ready","operator":"Exists","effect":"NoExecute","tolerationSeconds":300},{"key":"node.kubernetes.io/unreachable","operator":"Exists","effect":"NoExecute","tolerationSeconds":300}],"priority":0,"enableServiceLinks":true},"status":{"phase":"Running","conditions":[{"type":"Initialized","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-04-03T20:03:01Z"},{"type":"Ready","status":"False","lastProbeTime":null,"lastTransitionTime":"2019-04-03T20:03:46Z","reason":"ContainersNotReady","message":"containers with unready status: [database]"},{"type":"ContainersReady","status":"False","lastProbeTime":null,"lastTransitionTime":"2019-04-03T20:03:46Z","reason":"ContainersNotReady","message":"containers with unready status: [database]"},{"type":"PodScheduled","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-04-03T20:03:01Z"}],"hostIP":"10.128.0.54","podIP":"192.168.173.97","startTime":"2019-04-03T20:03:01Z","containerStatuses":[{"name":"database","state":{"terminated":{"exitCode":0,"startedAt":null,"finishedAt":null}},"lastState":{"terminated":{"exitCode":1,"reason":"Error","startedAt":"2019-04-03T20:04:32Z","finishedAt":"2019-04-03T20:04:33Z","containerID":"docker://b65e01f413f2db5e3222b29b22bd995b36dd9a8084a9fc1ef9059461afdbd421"}},"ready":false,"restartCount":4,"image":"mysql:latest","imageID":"docker-pullable://mysql@sha256:a7cf659a764732a27963429a87eccc8457e6d4af0ee9d5140a3b56e74986eed7","containerID":"docker://b65e01f413f2db5e3222b29b22bd995b36dd9a8084a9fc1ef9059461afdbd421"}],"qosClass":"BestEffort"}},"requestReceivedTimestamp":"2019-04-03T20:06:00.883771Z","stageTimestamp":"2019-04-03T20:06:00.895088Z","annotations":{"authorization.k8s.io/decision":"allow","authorization.k8s.io/reason":""},"name":"database-74656f569f-kjbhl"}},{"_index":"tigera_secure_ee_audit_kube.cluster.20190403","_type":"fluentd","_id":"pVfK5GkB5zWAjbhQfFVz","_score":2.121744,"_source":{"kind":"Event","apiVersion":"audit.k8s.io/v1","level":"RequestResponse","auditID":"2fdff576-f5cd-4367-9c78-ae0049c4e219","stage":"ResponseComplete","requestURI":"/api/v1/namespaces/compliance-testing/serviceaccounts/default","verb":"update","user":{"username":"system:kube-controller-manager","groups":["system:authenticated"]},"sourceIPs":["10.128.0.54"],"userAgent":"kube-controller-manager/v1.13.4 (linux/amd64) kubernetes/c27b913/tokens-controller","objectRef":{"resource":"serviceaccounts","namespace":"compliance-testing","name":"default","uid":"36529b95-564b-11e9-8550-42010a800036","apiVersion":"v1","resourceVersion":"239145"},"responseStatus":{"metadata":{},"code":200},"requestObject":{"kind":"ServiceAccount","apiVersion":"v1","metadata":{"name":"default","namespace":"compliance-testing","selfLink":"/api/v1/namespaces/compliance-testing/serviceaccounts/default","uid":"36529b95-564b-11e9-8550-42010a800036","resourceVersion":"239145","creationTimestamp":"2019-04-03T20:01:04Z"},"secrets":[{"name":"default-token-ttppt"}]},"responseObject":{"kind":"ServiceAccount","apiVersion":"v1","metadata":{"name":"default","namespace":"compliance-testing","selfLink":"/api/v1/namespaces/compliance-testing/serviceaccounts/default","uid":"36529b95-564b-11e9-8550-42010a800036","resourceVersion":"239147","creationTimestamp":"2019-04-03T20:01:04Z"},"secrets":[{"name":"default-token-ttppt"}]},"requestReceivedTimestamp":"2019-04-03T20:01:04.560000Z","stageTimestamp":"2019-04-03T20:01:04.563472Z","annotations":{"authorization.k8s.io/decision":"allow","authorization.k8s.io/reason":"RBAC: allowed by ClusterRoleBinding \"system:kube-controller-manager\" of ClusterRole \"system:kube-controller-manager\" to User \"system:kube-controller-manager\""},"name":"default"}},{"_index":"tigera_secure_ee_audit_kube.cluster.20190403","_type":"fluentd","_id":"wlfM5GkB5zWAjbhQWVW1","_score":2.121744,"_source":{"kind":"Event","apiVersion":"audit.k8s.io/v1","level":"RequestResponse","auditID":"61e49916-6a18-4c8f-a6c8-23cfa4f120aa","stage":"ResponseComplete","requestURI":"/api/v1/namespaces/compliance-testing/pods/database-f5c74785f-qnvpt","verb":"delete","user":{"username":"system:node:bkim-kadm-node-0","groups":["system:nodes","system:authenticated"]},"sourceIPs":["10.128.0.138"],"userAgent":"kubelet/v1.13.4 (linux/amd64) kubernetes/c27b913","objectRef":{"resource":"pods","namespace":"compliance-testing","name":"database-f5c74785f-qnvpt","apiVersion":"v1"},"responseStatus":{"metadata":{},"code":200},"requestObject":{"kind":"DeleteOptions","apiVersion":"v1","gracePeriodSeconds":0,"preconditions":{"uid":"42f8e905-564b-11e9-8550-42010a800036"}},"responseObject":{"kind":"Pod","apiVersion":"v1","metadata":{"name":"database-f5c74785f-qnvpt","generateName":"database-f5c74785f-","namespace":"compliance-testing","selfLink":"/api/v1/namespaces/compliance-testing/pods/database-f5c74785f-qnvpt","uid":"42f8e905-564b-11e9-8550-42010a800036","resourceVersion":"239506","creationTimestamp":"2019-04-03T20:01:25Z","deletionTimestamp":"2019-04-03T20:03:03Z","deletionGracePeriodSeconds":0,"labels":{"app":"database","pod-template-hash":"f5c74785f","version":"v1"},"ownerReferences":[{"apiVersion":"apps/v1","kind":"ReplicaSet","name":"database-f5c74785f","uid":"42f7023b-564b-11e9-8550-42010a800036","controller":true,"blockOwnerDeletion":true}]},"spec":{"volumes":[{"name":"database-token-fsjbn","secret":{"secretName":"database-token-fsjbn","defaultMode":420}}],"containers":[{"name":"database","image":"mysql","ports":[{"containerPort":3306,"protocol":"TCP"}],"resources":{},"volumeMounts":[{"name":"database-token-fsjbn","readOnly":true,"mountPath":"/var/run/secrets/kubernetes.io/serviceaccount"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"Always"}],"restartPolicy":"Always","terminationGracePeriodSeconds":30,"dnsPolicy":"ClusterFirst","serviceAccountName":"database","serviceAccount":"database","nodeName":"bkim-kadm-node-0","securityContext":{},"schedulerName":"default-scheduler","tolerations":[{"key":"node.kubernetes.io/not-ready","operator":"Exists","effect":"NoExecute","tolerationSeconds":300},{"key":"node.kubernetes.io/unreachable","operator":"Exists","effect":"NoExecute","tolerationSeconds":300}],"priority":0,"enableServiceLinks":true},"status":{"phase":"Running","conditions":[{"type":"Initialized","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-04-03T20:01:25Z"},{"type":"Ready","status":"False","lastProbeTime":null,"lastTransitionTime":"2019-04-03T20:01:47Z","reason":"ContainersNotReady","message":"containers with unready status: [database]"},{"type":"ContainersReady","status":"False","lastProbeTime":null,"lastTransitionTime":"2019-04-03T20:01:47Z","reason":"ContainersNotReady","message":"containers with unready status: [database]"},{"type":"PodScheduled","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-04-03T20:01:25Z"}],"hostIP":"10.128.0.138","podIP":"192.168.166.78","startTime":"2019-04-03T20:01:25Z","containerStatuses":[{"name":"database","state":{"terminated":{"exitCode":0,"startedAt":null,"finishedAt":null}},"lastState":{"terminated":{"exitCode":1,"reason":"Error","startedAt":"2019-04-03T20:02:18Z","finishedAt":"2019-04-03T20:02:18Z","containerID":"docker://8f594fc97b8d98725ae63cd2c337685d719a0b429fd3c1407e529717feae763b"}},"ready":false,"restartCount":3,"image":"mysql:latest","imageID":"docker-pullable://mysql@sha256:a7cf659a764732a27963429a87eccc8457e6d4af0ee9d5140a3b56e74986eed7","containerID":"docker://8f594fc97b8d98725ae63cd2c337685d719a0b429fd3c1407e529717feae763b"}],"qosClass":"BestEffort"}},"requestReceivedTimestamp":"2019-04-03T20:03:06.172826Z","stageTimestamp":"2019-04-03T20:03:06.183915Z","annotations":{"authorization.k8s.io/decision":"allow","authorization.k8s.io/reason":""},"name":"database-f5c74785f-qnvpt"}},{"_index":"tigera_secure_ee_audit_kube.cluster.20190403","_type":"fluentd","_id":"5lfO5GkB5zWAjbhQ3FVa","_score":2.121744,"_source":{"kind":"Event","apiVersion":"audit.k8s.io/v1","level":"RequestResponse","auditID":"6b75f5b7-80dd-4cd9-8c1f-fb28f7883451","stage":"ResponseComplete","requestURI":"/api/v1/namespaces/compliance-testing/pods/database-74656f569f-6cvcb","verb":"delete","user":{"username":"system:serviceaccount:kube-system:generic-garbage-collector","uid":"9ef9bd97-54cb-11e9-8243-42010a800036","groups":["system:serviceaccounts","system:serviceaccounts:kube-system","system:authenticated"]},"sourceIPs":["10.128.0.54"],"userAgent":"kube-controller-manager/v1.13.4 (linux/amd64) kubernetes/c27b913/system:serviceaccount:kube-system:generic-garbage-collector","objectRef":{"resource":"pods","namespace":"compliance-testing","name":"database-74656f569f-6cvcb","apiVersion":"v1"},"responseStatus":{"metadata":{},"code":200},"requestObject":{"kind":"DeleteOptions","apiVersion":"v1","preconditions":{"uid":"7d29f50e-564b-11e9-8550-42010a800036"},"propagationPolicy":"Background"},"responseObject":{"kind":"Pod","apiVersion":"v1","metadata":{"name":"database-74656f569f-6cvcb","generateName":"database-74656f569f-","namespace":"compliance-testing","selfLink":"/api/v1/namespaces/compliance-testing/pods/database-74656f569f-6cvcb","uid":"7d29f50e-564b-11e9-8550-42010a800036","resourceVersion":"239828","creationTimestamp":"2019-04-03T20:03:03Z","deletionTimestamp":"2019-04-03T20:06:19Z","deletionGracePeriodSeconds":30,"labels":{"app":"database","pod-template-hash":"74656f569f","version":"v2"},"ownerReferences":[{"apiVersion":"apps/v1","kind":"ReplicaSet","name":"database-74656f569f","uid":"7bd0c8c0-564b-11e9-8550-42010a800036","controller":true,"blockOwnerDeletion":true}]},"spec":{"volumes":[{"name":"database-token-fsjbn","secret":{"secretName":"database-token-fsjbn","defaultMode":420}}],"containers":[{"name":"database","image":"mysql","ports":[{"containerPort":3307,"protocol":"TCP"}],"resources":{},"volumeMounts":[{"name":"database-token-fsjbn","readOnly":true,"mountPath":"/var/run/secrets/kubernetes.io/serviceaccount"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"Always"}],"restartPolicy":"Always","terminationGracePeriodSeconds":30,"dnsPolicy":"ClusterFirst","serviceAccountName":"database","serviceAccount":"database","nodeName":"bkim-kadm-node-0","securityContext":{},"schedulerName":"default-scheduler","tolerations":[{"key":"node.kubernetes.io/not-ready","operator":"Exists","effect":"NoExecute","tolerationSeconds":300},{"key":"node.kubernetes.io/unreachable","operator":"Exists","effect":"NoExecute","tolerationSeconds":300}],"priority":0,"enableServiceLinks":true},"status":{"phase":"Running","conditions":[{"type":"Initialized","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-04-03T20:03:03Z"},{"type":"Ready","status":"False","lastProbeTime":null,"lastTransitionTime":"2019-04-03T20:03:22Z","reason":"ContainersNotReady","message":"containers with unready status: [database]"},{"type":"ContainersReady","status":"False","lastProbeTime":null,"lastTransitionTime":"2019-04-03T20:03:22Z","reason":"ContainersNotReady","message":"containers with unready status: [database]"},{"type":"PodScheduled","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-04-03T20:03:03Z"}],"hostIP":"10.128.0.138","podIP":"192.168.166.79","startTime":"2019-04-03T20:03:03Z","containerStatuses":[{"name":"database","state":{"waiting":{"reason":"CrashLoopBackOff","message":"Back-off 1m20s restarting failed container=database pod=database-74656f569f-6cvcb_compliance-testing(7d29f50e-564b-11e9-8550-42010a800036)"}},"lastState":{"terminated":{"exitCode":1,"reason":"Error","startedAt":"2019-04-03T20:04:31Z","finishedAt":"2019-04-03T20:04:31Z","containerID":"docker://250f3eb72d002937f16b49880d40c726c816653e1e984335841e84bbe7765523"}},"ready":false,"restartCount":4,"image":"mysql:latest","imageID":"docker-pullable://mysql@sha256:a7cf659a764732a27963429a87eccc8457e6d4af0ee9d5140a3b56e74986eed7","containerID":"docker://250f3eb72d002937f16b49880d40c726c816653e1e984335841e84bbe7765523"}],"qosClass":"BestEffort"}},"requestReceivedTimestamp":"2019-04-03T20:05:49.802961Z","stageTimestamp":"2019-04-03T20:05:49.810738Z","annotations":{"authorization.k8s.io/decision":"allow","authorization.k8s.io/reason":"RBAC: allowed by ClusterRoleBinding \"system:controller:generic-garbage-collector\" of ClusterRole \"system:controller:generic-garbage-collector\" to ServiceAccount \"generic-garbage-collector/kube-system\""},"name":"database-74656f569f-6cvcb"}},{"_index":"tigera_secure_ee_audit_kube.cluster.20190403","_type":"fluentd","_id":"7lfP5GkB5zWAjbhQP1XF","_score":2.121744,"_source":{"kind":"Event","apiVersion":"audit.k8s.io/v1","level":"RequestResponse","auditID":"5a726d21-4f24-40b1-afbc-e91f55991a27","stage":"ResponseComplete","requestURI":"/api/v1/namespaces/compliance-testing/serviceaccounts/default","verb":"update","user":{"username":"system:kube-controller-manager","groups":["system:authenticated"]},"sourceIPs":["10.128.0.54"],"userAgent":"kube-controller-manager/v1.13.4 (linux/amd64) kubernetes/c27b913/tokens-controller","objectRef":{"resource":"serviceaccounts","namespace":"compliance-testing","name":"default","uid":"36529b95-564b-11e9-8550-42010a800036","apiVersion":"v1","resourceVersion":"239147"},"responseStatus":{"metadata":{},"code":200},"requestObject":{"kind":"ServiceAccount","apiVersion":"v1","metadata":{"name":"default","namespace":"compliance-testing","selfLink":"/api/v1/namespaces/compliance-testing/serviceaccounts/default","uid":"36529b95-564b-11e9-8550-42010a800036","resourceVersion":"239147","creationTimestamp":"2019-04-03T20:01:04Z"}},"responseObject":{"kind":"ServiceAccount","apiVersion":"v1","metadata":{"name":"default","namespace":"compliance-testing","selfLink":"/api/v1/namespaces/compliance-testing/serviceaccounts/default","uid":"36529b95-564b-11e9-8550-42010a800036","resourceVersion":"239913","creationTimestamp":"2019-04-03T20:01:04Z"}},"requestReceivedTimestamp":"2019-04-03T20:06:15.673869Z","stageTimestamp":"2019-04-03T20:06:15.678083Z","annotations":{"authorization.k8s.io/decision":"allow","authorization.k8s.io/reason":"RBAC: allowed by ClusterRoleBinding \"system:kube-controller-manager\" of ClusterRole \"system:kube-controller-manager\" to User \"system:kube-controller-manager\""},"name":"default"}},{"_index":"tigera_secure_ee_audit_kube.cluster.20190403","_type":"fluentd","_id":"q1fK5GkB5zWAjbhQ01XY","_score":1.3862944,"_source":{"kind":"Event","apiVersion":"audit.k8s.io/v1","level":"RequestResponse","auditID":"e4b847f7-cc82-4fef-ba18-e45e2f05053a","stage":"ResponseComplete","requestURI":"/api/v1/namespaces/compliance-testing/pods","verb":"create","user":{"username":"system:serviceaccount:kube-system:replicaset-controller","uid":"9e4a480e-54cb-11e9-8243-42010a800036","groups":["system:serviceaccounts","system:serviceaccounts:kube-system","system:authenticated"]},"sourceIPs":["10.128.0.54"],"userAgent":"kube-controller-manager/v1.13.4 (linux/amd64) kubernetes/c27b913/system:serviceaccount:kube-system:replicaset-controller","objectRef":{"resource":"pods","namespace":"compliance-testing","apiVersion":"v1"},"responseStatus":{"metadata":{},"code":201},"requestObject":{"kind":"Pod","apiVersion":"v1","metadata":{"generateName":"database-f5c74785f-","creationTimestamp":null,"labels":{"app":"database","pod-template-hash":"f5c74785f","version":"v1"},"ownerReferences":[{"apiVersion":"apps/v1","kind":"ReplicaSet","name":"database-f5c74785f","uid":"42f7023b-564b-11e9-8550-42010a800036","controller":true,"blockOwnerDeletion":true}]},"spec":{"containers":[{"name":"database","image":"mysql","ports":[{"containerPort":3306,"protocol":"TCP"}],"resources":{},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"Always"}],"restartPolicy":"Always","terminationGracePeriodSeconds":30,"dnsPolicy":"ClusterFirst","serviceAccountName":"database","serviceAccount":"database","securityContext":{},"schedulerName":"default-scheduler","enableServiceLinks":true},"status":{}},"responseObject":{"kind":"Pod","apiVersion":"v1","metadata":{"name":"database-f5c74785f-qnvpt","generateName":"database-f5c74785f-","namespace":"compliance-testing","selfLink":"/api/v1/namespaces/compliance-testing/pods/database-f5c74785f-qnvpt","uid":"42f8e905-564b-11e9-8550-42010a800036","resourceVersion":"239186","creationTimestamp":"2019-04-03T20:01:25Z","labels":{"app":"database","pod-template-hash":"f5c74785f","version":"v1"},"ownerReferences":[{"apiVersion":"apps/v1","kind":"ReplicaSet","name":"database-f5c74785f","uid":"42f7023b-564b-11e9-8550-42010a800036","controller":true,"blockOwnerDeletion":true}]},"spec":{"volumes":[{"name":"database-token-fsjbn","secret":{"secretName":"database-token-fsjbn","defaultMode":420}}],"containers":[{"name":"database","image":"mysql","ports":[{"containerPort":3306,"protocol":"TCP"}],"resources":{},"volumeMounts":[{"name":"database-token-fsjbn","readOnly":true,"mountPath":"/var/run/secrets/kubernetes.io/serviceaccount"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"Always"}],"restartPolicy":"Always","terminationGracePeriodSeconds":30,"dnsPolicy":"ClusterFirst","serviceAccountName":"database","serviceAccount":"database","securityContext":{},"schedulerName":"default-scheduler","tolerations":[{"key":"node.kubernetes.io/not-ready","operator":"Exists","effect":"NoExecute","tolerationSeconds":300},{"key":"node.kubernetes.io/unreachable","operator":"Exists","effect":"NoExecute","tolerationSeconds":300}],"priority":0,"enableServiceLinks":true},"status":{"phase":"Pending","qosClass":"BestEffort"}},"requestReceivedTimestamp":"2019-04-03T20:01:25.762119Z","stageTimestamp":"2019-04-03T20:01:25.769809Z","annotations":{"authorization.k8s.io/decision":"allow","authorization.k8s.io/reason":"RBAC: allowed by ClusterRoleBinding \"system:controller:replicaset-controller\" of ClusterRole \"system:controller:replicaset-controller\" to ServiceAccount \"replicaset-controller/kube-system\""},"name":"database-f5c74785f-qnvpt"}},{"_index":"tigera_secure_ee_audit_kube.cluster.20190403","_type":"fluentd","_id":"rFfK5GkB5zWAjbhQ01XY","_score":1.3862944,"_source":{"kind":"Event","apiVersion":"audit.k8s.io/v1","level":"RequestResponse","auditID":"6aac3ef7-fbcd-49bc-95d7-4fee3b74dec5","stage":"ResponseComplete","requestURI":"/api/v1/namespaces/compliance-testing/pods","verb":"create","user":{"username":"system:serviceaccount:kube-system:replicaset-controller","uid":"9e4a480e-54cb-11e9-8243-42010a800036","groups":["system:serviceaccounts","system:serviceaccounts:kube-system","system:authenticated"]},"sourceIPs":["10.128.0.54"],"userAgent":"kube-controller-manager/v1.13.4 (linux/amd64) kubernetes/c27b913/system:serviceaccount:kube-system:replicaset-controller","objectRef":{"resource":"pods","namespace":"compliance-testing","apiVersion":"v1"},"responseStatus":{"metadata":{},"code":201},"requestObject":{"kind":"Pod","apiVersion":"v1","metadata":{"generateName":"database-f5c74785f-","creationTimestamp":null,"labels":{"app":"database","pod-template-hash":"f5c74785f","version":"v1"},"ownerReferences":[{"apiVersion":"apps/v1","kind":"ReplicaSet","name":"database-f5c74785f","uid":"42f7023b-564b-11e9-8550-42010a800036","controller":true,"blockOwnerDeletion":true}]},"spec":{"containers":[{"name":"database","image":"mysql","ports":[{"containerPort":3306,"protocol":"TCP"}],"resources":{},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"Always"}],"restartPolicy":"Always","terminationGracePeriodSeconds":30,"dnsPolicy":"ClusterFirst","serviceAccountName":"database","serviceAccount":"database","securityContext":{},"schedulerName":"default-scheduler","enableServiceLinks":true},"status":{}},"responseObject":{"kind":"Pod","apiVersion":"v1","metadata":{"name":"database-f5c74785f-m7vd2","generateName":"database-f5c74785f-","namespace":"compliance-testing","selfLink":"/api/v1/namespaces/compliance-testing/pods/database-f5c74785f-m7vd2","uid":"42f9fc99-564b-11e9-8550-42010a800036","resourceVersion":"239189","creationTimestamp":"2019-04-03T20:01:25Z","labels":{"app":"database","pod-template-hash":"f5c74785f","version":"v1"},"ownerReferences":[{"apiVersion":"apps/v1","kind":"ReplicaSet","name":"database-f5c74785f","uid":"42f7023b-564b-11e9-8550-42010a800036","controller":true,"blockOwnerDeletion":true}]},"spec":{"volumes":[{"name":"database-token-fsjbn","secret":{"secretName":"database-token-fsjbn","defaultMode":420}}],"containers":[{"name":"database","image":"mysql","ports":[{"containerPort":3306,"protocol":"TCP"}],"resources":{},"volumeMounts":[{"name":"database-token-fsjbn","readOnly":true,"mountPath":"/var/run/secrets/kubernetes.io/serviceaccount"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"Always"}],"restartPolicy":"Always","terminationGracePeriodSeconds":30,"dnsPolicy":"ClusterFirst","serviceAccountName":"database","serviceAccount":"database","securityContext":{},"schedulerName":"default-scheduler","tolerations":[{"key":"node.kubernetes.io/not-ready","operator":"Exists","effect":"NoExecute","tolerationSeconds":300},{"key":"node.kubernetes.io/unreachable","operator":"Exists","effect":"NoExecute","tolerationSeconds":300}],"priority":0,"enableServiceLinks":true},"status":{"phase":"Pending","qosClass":"BestEffort"}},"requestReceivedTimestamp":"2019-04-03T20:01:25.771723Z","stageTimestamp":"2019-04-03T20:01:25.787519Z","annotations":{"authorization.k8s.io/decision":"allow","authorization.k8s.io/reason":"RBAC: allowed by ClusterRoleBinding \"system:controller:replicaset-controller\" of ClusterRole \"system:controller:replicaset-controller\" to ServiceAccount \"replicaset-controller/kube-system\""},"name":"database-f5c74785f-m7vd2"}},{"_index":"tigera_secure_ee_audit_kube.cluster.20190403","_type":"fluentd","_id":"r1fL5GkB5zWAjbhQJlVd","_score":1.3862944,"_source":{"kind":"Event","apiVersion":"audit.k8s.io/v1","level":"RequestResponse","auditID":"2a1bf0df-3252-4535-9f4f-6dd97fcad8d1","stage":"ResponseComplete","requestURI":"/apis/networking.k8s.io/v1/namespaces/compliance-testing/networkpolicies","verb":"create","user":{"username":"kubernetes-admin","groups":["system:masters","system:authenticated"]},"sourceIPs":["199.116.73.11"],"userAgent":"kubectl/v1.13.4 (darwin/amd64) kubernetes/c27b913","objectRef":{"resource":"networkpolicies","namespace":"compliance-testing","name":"default-deny","apiGroup":"networking.k8s.io","apiVersion":"v1"},"responseStatus":{"metadata":{},"code":201},"requestObject":{"kind":"NetworkPolicy","apiVersion":"networking.k8s.io/v1","metadata":{"name":"default-deny","namespace":"compliance-testing","creationTimestamp":null,"annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"networking.k8s.io/v1\",\"kind\":\"NetworkPolicy\",\"metadata\":{\"annotations\":{},\"name\":\"default-deny\",\"namespace\":\"compliance-testing\"},\"spec\":{\"podSelector\":{\"matchLabels\":{}}}}\n"}},"spec":{"podSelector":{},"policyTypes":["Ingress"]}},"responseObject":{"kind":"NetworkPolicy","apiVersion":"networking.k8s.io/v1","metadata":{"name":"default-deny","namespace":"compliance-testing","selfLink":"/apis/networking.k8s.io/v1/namespaces/compliance-testing/networkpolicies/default-deny","uid":"4f794df8-564b-11e9-8550-42010a800036","resourceVersion":"239294","generation":1,"creationTimestamp":"2019-04-03T20:01:46Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"networking.k8s.io/v1\",\"kind\":\"NetworkPolicy\",\"metadata\":{\"annotations\":{},\"name\":\"default-deny\",\"namespace\":\"compliance-testing\"},\"spec\":{\"podSelector\":{\"matchLabels\":{}}}}\n"}},"spec":{"podSelector":{},"policyTypes":["Ingress"]}},"requestReceivedTimestamp":"2019-04-03T20:01:46.738913Z","stageTimestamp":"2019-04-03T20:01:46.743236Z","annotations":{"authorization.k8s.io/decision":"allow","authorization.k8s.io/reason":""},"name":"default-deny"}},{"_index":"tigera_secure_ee_audit_kube.cluster.20190403","_type":"fluentd","_id":"xVfM5GkB5zWAjbhQmVUQ","_score":1.3862944,"_source":{"kind":"Event","apiVersion":"audit.k8s.io/v1","level":"RequestResponse","auditID":"f098027b-9a6e-46e0-9a68-0b81a6c7200f","stage":"ResponseComplete","requestURI":"/apis/networking.k8s.io/v1/namespaces/compliance-testing/networkpolicies/default-deny","verb":"patch","user":{"username":"kubernetes-admin","groups":["system:masters","system:authenticated"]},"sourceIPs":["199.116.73.11"],"userAgent":"kubectl/v1.13.4 (darwin/amd64) kubernetes/c27b913","objectRef":{"resource":"networkpolicies","namespace":"compliance-testing","name":"default-deny","apiGroup":"networking.k8s.io","apiVersion":"v1"},"responseStatus":{"metadata":{},"code":200},"requestObject":{"metadata":{"annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"networking.k8s.io/v1\",\"kind\":\"NetworkPolicy\",\"metadata\":{\"annotations\":{},\"name\":\"default-deny\",\"namespace\":\"compliance-testing\"},\"spec\":{\"podSelector\":{\"matchLabels\":{\"app\":\"summary\"}}}}\n"}},"spec":{"podSelector":{"matchLabels":{"app":"summary"}}}},"responseObject":{"kind":"NetworkPolicy","apiVersion":"networking.k8s.io/v1","metadata":{"name":"default-deny","namespace":"compliance-testing","selfLink":"/apis/networking.k8s.io/v1/namespaces/compliance-testing/networkpolicies/default-deny","uid":"4f794df8-564b-11e9-8550-42010a800036","resourceVersion":"239566","generation":2,"creationTimestamp":"2019-04-03T20:01:46Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"networking.k8s.io/v1\",\"kind\":\"NetworkPolicy\",\"metadata\":{\"annotations\":{},\"name\":\"default-deny\",\"namespace\":\"compliance-testing\"},\"spec\":{\"podSelector\":{\"matchLabels\":{\"app\":\"summary\"}}}}\n"}},"spec":{"podSelector":{"matchLabels":{"app":"summary"}},"policyTypes":["Ingress"]}},"requestReceivedTimestamp":"2019-04-03T20:03:21.897705Z","stageTimestamp":"2019-04-03T20:03:21.904695Z","annotations":{"authorization.k8s.io/decision":"allow","authorization.k8s.io/reason":""},"name":"default-deny"}},{"_index":"tigera_secure_ee_audit_kube.cluster.20190403","_type":"fluentd","_id":"6FfO5GkB5zWAjbhQ3FVa","_score":1.3862944,"_source":{"kind":"Event","apiVersion":"audit.k8s.io/v1","level":"RequestResponse","auditID":"f1d8de00-1703-469e-bd84-4b772761de40","stage":"ResponseComplete","requestURI":"/api/v1/namespaces/compliance-testing/pods/database-f5c74785f-m7vd2","verb":"delete","user":{"username":"system:node:bkim-kadm-node-1","groups":["system:nodes","system:authenticated"]},"sourceIPs":["10.128.0.133"],"userAgent":"kubelet/v1.13.4 (linux/amd64) kubernetes/c27b913","objectRef":{"resource":"pods","namespace":"compliance-testing","name":"database-f5c74785f-m7vd2","apiVersion":"v1"},"responseStatus":{"metadata":{},"code":200},"requestObject":{"kind":"DeleteOptions","apiVersion":"v1","gracePeriodSeconds":0,"preconditions":{"uid":"42f9fc99-564b-11e9-8550-42010a800036"}},"responseObject":{"kind":"Pod","apiVersion":"v1","metadata":{"name":"database-f5c74785f-m7vd2","generateName":"database-f5c74785f-","namespace":"compliance-testing","selfLink":"/api/v1/namespaces/compliance-testing/pods/database-f5c74785f-m7vd2","uid":"42f9fc99-564b-11e9-8550-42010a800036","resourceVersion":"239837","creationTimestamp":"2019-04-03T20:01:25Z","deletionTimestamp":"2019-04-03T20:05:49Z","deletionGracePeriodSeconds":0,"labels":{"app":"database","pod-template-hash":"f5c74785f","version":"v1"},"ownerReferences":[{"apiVersion":"apps/v1","kind":"ReplicaSet","name":"database-f5c74785f","uid":"42f7023b-564b-11e9-8550-42010a800036","controller":true,"blockOwnerDeletion":true}]},"spec":{"volumes":[{"name":"database-token-fsjbn","secret":{"secretName":"database-token-fsjbn","defaultMode":420}}],"containers":[{"name":"database","image":"mysql","ports":[{"containerPort":3306,"protocol":"TCP"}],"resources":{},"volumeMounts":[{"name":"database-token-fsjbn","readOnly":true,"mountPath":"/var/run/secrets/kubernetes.io/serviceaccount"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"Always"}],"restartPolicy":"Always","terminationGracePeriodSeconds":30,"dnsPolicy":"ClusterFirst","serviceAccountName":"database","serviceAccount":"database","nodeName":"bkim-kadm-node-1","securityContext":{},"schedulerName":"default-scheduler","tolerations":[{"key":"node.kubernetes.io/not-ready","operator":"Exists","effect":"NoExecute","tolerationSeconds":300},{"key":"node.kubernetes.io/unreachable","operator":"Exists","effect":"NoExecute","tolerationSeconds":300}],"priority":0,"enableServiceLinks":true},"status":{"phase":"Running","conditions":[{"type":"Initialized","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-04-03T20:01:25Z"},{"type":"Ready","status":"False","lastProbeTime":null,"lastTransitionTime":"2019-04-03T20:03:03Z","reason":"ContainersNotReady","message":"containers with unready status: [database]"},{"type":"ContainersReady","status":"False","lastProbeTime":null,"lastTransitionTime":"2019-04-03T20:03:03Z","reason":"ContainersNotReady","message":"containers with unready status: [database]"},{"type":"PodScheduled","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-04-03T20:01:25Z"}],"hostIP":"10.128.0.133","podIP":"192.168.88.110","startTime":"2019-04-03T20:01:25Z","containerStatuses":[{"name":"database","state":{"terminated":{"exitCode":0,"startedAt":null,"finishedAt":null}},"lastState":{"terminated":{"exitCode":1,"reason":"Error","startedAt":"2019-04-03T20:04:26Z","finishedAt":"2019-04-03T20:04:26Z","containerID":"docker://c2078bf0b3a77c344e2033291617ae548d315c8e34fc8c3591378c636127a40d"}},"ready":false,"restartCount":5,"image":"mysql:latest","imageID":"docker-pullable://mysql@sha256:a7cf659a764732a27963429a87eccc8457e6d4af0ee9d5140a3b56e74986eed7","containerID":"docker://c2078bf0b3a77c344e2033291617ae548d315c8e34fc8c3591378c636127a40d"}],"qosClass":"BestEffort"}},"requestReceivedTimestamp":"2019-04-03T20:05:52.557881Z","stageTimestamp":"2019-04-03T20:05:52.566172Z","annotations":{"authorization.k8s.io/decision":"allow","authorization.k8s.io/reason":""},"name":"database-f5c74785f-m7vd2"}},{"_index":"tigera_secure_ee_audit_kube.cluster.20190403","_type":"fluentd","_id":"6VfO5GkB5zWAjbhQ8VV5","_score":0.9135168,"_source":{"kind":"Event","apiVersion":"audit.k8s.io/v1","level":"RequestResponse","auditID":"8a04e4c1-ba51-4ded-be6a-3d3ce6bb7222","stage":"ResponseComplete","requestURI":"/api/v1/namespaces/compliance-testing/pods/database-74656f569f-6cvcb","verb":"delete","user":{"username":"system:node:bkim-kadm-node-0","groups":["system:nodes","system:authenticated"]},"sourceIPs":["10.128.0.138"],"userAgent":"kubelet/v1.13.4 (linux/amd64) kubernetes/c27b913","objectRef":{"resource":"pods","namespace":"compliance-testing","name":"database-74656f569f-6cvcb","apiVersion":"v1"},"responseStatus":{"metadata":{},"code":200},"requestObject":{"kind":"DeleteOptions","apiVersion":"v1","gracePeriodSeconds":0,"preconditions":{"uid":"7d29f50e-564b-11e9-8550-42010a800036"}},"responseObject":{"kind":"Pod","apiVersion":"v1","metadata":{"name":"database-74656f569f-6cvcb","generateName":"database-74656f569f-","namespace":"compliance-testing","selfLink":"/api/v1/namespaces/compliance-testing/pods/database-74656f569f-6cvcb","uid":"7d29f50e-564b-11e9-8550-42010a800036","resourceVersion":"239844","creationTimestamp":"2019-04-03T20:03:03Z","deletionTimestamp":"2019-04-03T20:05:49Z","deletionGracePeriodSeconds":0,"labels":{"app":"database","pod-template-hash":"74656f569f","version":"v2"},"ownerReferences":[{"apiVersion":"apps/v1","kind":"ReplicaSet","name":"database-74656f569f","uid":"7bd0c8c0-564b-11e9-8550-42010a800036","controller":true,"blockOwnerDeletion":true}]},"spec":{"volumes":[{"name":"database-token-fsjbn","secret":{"secretName":"database-token-fsjbn","defaultMode":420}}],"containers":[{"name":"database","image":"mysql","ports":[{"containerPort":3307,"protocol":"TCP"}],"resources":{},"volumeMounts":[{"name":"database-token-fsjbn","readOnly":true,"mountPath":"/var/run/secrets/kubernetes.io/serviceaccount"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"Always"}],"restartPolicy":"Always","terminationGracePeriodSeconds":30,"dnsPolicy":"ClusterFirst","serviceAccountName":"database","serviceAccount":"database","nodeName":"bkim-kadm-node-0","securityContext":{},"schedulerName":"default-scheduler","tolerations":[{"key":"node.kubernetes.io/not-ready","operator":"Exists","effect":"NoExecute","tolerationSeconds":300},{"key":"node.kubernetes.io/unreachable","operator":"Exists","effect":"NoExecute","tolerationSeconds":300}],"priority":0,"enableServiceLinks":true},"status":{"phase":"Running","conditions":[{"type":"Initialized","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-04-03T20:03:03Z"},{"type":"Ready","status":"False","lastProbeTime":null,"lastTransitionTime":"2019-04-03T20:03:22Z","reason":"ContainersNotReady","message":"containers with unready status: [database]"},{"type":"ContainersReady","status":"False","lastProbeTime":null,"lastTransitionTime":"2019-04-03T20:03:22Z","reason":"ContainersNotReady","message":"containers with unready status: [database]"},{"type":"PodScheduled","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-04-03T20:03:03Z"}],"hostIP":"10.128.0.138","podIP":"192.168.166.79","startTime":"2019-04-03T20:03:03Z","containerStatuses":[{"name":"database","state":{"terminated":{"exitCode":0,"startedAt":null,"finishedAt":null}},"lastState":{"terminated":{"exitCode":1,"reason":"Error","startedAt":"2019-04-03T20:04:31Z","finishedAt":"2019-04-03T20:04:31Z","containerID":"docker://250f3eb72d002937f16b49880d40c726c816653e1e984335841e84bbe7765523"}},"ready":false,"restartCount":4,"image":"mysql:latest","imageID":"docker-pullable://mysql@sha256:a7cf659a764732a27963429a87eccc8457e6d4af0ee9d5140a3b56e74986eed7","containerID":"docker://250f3eb72d002937f16b49880d40c726c816653e1e984335841e84bbe7765523"}],"qosClass":"BestEffort"}},"requestReceivedTimestamp":"2019-04-03T20:05:56.171782Z","stageTimestamp":"2019-04-03T20:05:56.177980Z","annotations":{"authorization.k8s.io/decision":"allow","authorization.k8s.io/reason":""},"name":"database-74656f569f-6cvcb"}},{"_index":"tigera_secure_ee_audit_kube.cluster.20190403","_type":"fluentd","_id":"6lfO5GkB5zWAjbhQ8VV5","_score":0.9135168,"_source":{"kind":"Event","apiVersion":"audit.k8s.io/v1","level":"RequestResponse","auditID":"363f7658-5750-42fe-99de-b27951fe6439","stage":"ResponseComplete","requestURI":"/api/v1/namespaces/compliance-testing/serviceaccounts/database","verb":"delete","user":{"username":"kubernetes-admin","groups":["system:masters","system:authenticated"]},"sourceIPs":["199.116.73.11"],"userAgent":"kubectl/v1.13.4 (darwin/amd64) kubernetes/c27b913","objectRef":{"resource":"serviceaccounts","namespace":"compliance-testing","name":"database","apiVersion":"v1"},"responseStatus":{"metadata":{},"code":200},"requestObject":{"kind":"DeleteOptions","apiVersion":"v1","propagationPolicy":"Background"},"responseObject":{"kind":"ServiceAccount","apiVersion":"v1","metadata":{"name":"database","namespace":"compliance-testing","selfLink":"/api/v1/namespaces/compliance-testing/serviceaccounts/database","uid":"3ca6c1fe-564b-11e9-8550-42010a800036","resourceVersion":"239411","creationTimestamp":"2019-04-03T20:01:15Z","labels":{"app":"database","foo":"bar"},"annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"v1\",\"kind\":\"ServiceAccount\",\"metadata\":{\"annotations\":{},\"labels\":{\"app\":\"database\",\"foo\":\"bar\"},\"name\":\"database\",\"namespace\":\"compliance-testing\"}}\n"}},"secrets":[{"name":"database-token-fsjbn"}]},"requestReceivedTimestamp":"2019-04-03T20:06:00.078953Z","stageTimestamp":"2019-04-03T20:06:00.082762Z","annotations":{"authorization.k8s.io/decision":"allow","authorization.k8s.io/reason":""},"name":"database"}},{"_index":"tigera_secure_ee_audit_kube.cluster.20190403","_type":"fluentd","_id":"51fO5GkB5zWAjbhQ3FVa","_score":0.9135168,"_source":{"kind":"Event","apiVersion":"audit.k8s.io/v1","level":"RequestResponse","auditID":"e64e02ef-9202-4cfd-bd2f-cbfa6a4c4417","stage":"ResponseComplete","requestURI":"/api/v1/namespaces/compliance-testing/pods/database-74656f569f-kjbhl","verb":"delete","user":{"username":"system:serviceaccount:kube-system:generic-garbage-collector","uid":"9ef9bd97-54cb-11e9-8243-42010a800036","groups":["system:serviceaccounts","system:serviceaccounts:kube-system","system:authenticated"]},"sourceIPs":["10.128.0.54"],"userAgent":"kube-controller-manager/v1.13.4 (linux/amd64) kubernetes/c27b913/system:serviceaccount:kube-system:generic-garbage-collector","objectRef":{"resource":"pods","namespace":"compliance-testing","name":"database-74656f569f-kjbhl","apiVersion":"v1"},"responseStatus":{"metadata":{},"code":200},"requestObject":{"kind":"DeleteOptions","apiVersion":"v1","preconditions":{"uid":"7bd389e8-564b-11e9-8550-42010a800036"},"propagationPolicy":"Background"},"responseObject":{"kind":"Pod","apiVersion":"v1","metadata":{"name":"database-74656f569f-kjbhl","generateName":"database-74656f569f-","namespace":"compliance-testing","selfLink":"/api/v1/namespaces/compliance-testing/pods/database-74656f569f-kjbhl","uid":"7bd389e8-564b-11e9-8550-42010a800036","resourceVersion":"239829","creationTimestamp":"2019-04-03T20:03:01Z","deletionTimestamp":"2019-04-03T20:06:19Z","deletionGracePeriodSeconds":30,"labels":{"app":"database","pod-template-hash":"74656f569f","version":"v2"},"ownerReferences":[{"apiVersion":"apps/v1","kind":"ReplicaSet","name":"database-74656f569f","uid":"7bd0c8c0-564b-11e9-8550-42010a800036","controller":true,"blockOwnerDeletion":true}]},"spec":{"volumes":[{"name":"database-token-fsjbn","secret":{"secretName":"database-token-fsjbn","defaultMode":420}}],"containers":[{"name":"database","image":"mysql","ports":[{"containerPort":3307,"protocol":"TCP"}],"resources":{},"volumeMounts":[{"name":"database-token-fsjbn","readOnly":true,"mountPath":"/var/run/secrets/kubernetes.io/serviceaccount"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"Always"}],"restartPolicy":"Always","terminationGracePeriodSeconds":30,"dnsPolicy":"ClusterFirst","serviceAccountName":"database","serviceAccount":"database","nodeName":"bkim-kadm-ms","securityContext":{},"schedulerName":"default-scheduler","tolerations":[{"key":"node.kubernetes.io/not-ready","operator":"Exists","effect":"NoExecute","tolerationSeconds":300},{"key":"node.kubernetes.io/unreachable","operator":"Exists","effect":"NoExecute","tolerationSeconds":300}],"priority":0,"enableServiceLinks":true},"status":{"phase":"Running","conditions":[{"type":"Initialized","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-04-03T20:03:01Z"},{"type":"Ready","status":"False","lastProbeTime":null,"lastTransitionTime":"2019-04-03T20:03:46Z","reason":"ContainersNotReady","message":"containers with unready status: [database]"},{"type":"ContainersReady","status":"False","lastProbeTime":null,"lastTransitionTime":"2019-04-03T20:03:46Z","reason":"ContainersNotReady","message":"containers with unready status: [database]"},{"type":"PodScheduled","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-04-03T20:03:01Z"}],"hostIP":"10.128.0.54","podIP":"192.168.173.97","startTime":"2019-04-03T20:03:01Z","containerStatuses":[{"name":"database","state":{"waiting":{"reason":"CrashLoopBackOff","message":"Back-off 1m20s restarting failed container=database pod=database-74656f569f-kjbhl_compliance-testing(7bd389e8-564b-11e9-8550-42010a800036)"}},"lastState":{"terminated":{"exitCode":1,"reason":"Error","startedAt":"2019-04-03T20:04:32Z","finishedAt":"2019-04-03T20:04:33Z","containerID":"docker://b65e01f413f2db5e3222b29b22bd995b36dd9a8084a9fc1ef9059461afdbd421"}},"ready":false,"restartCount":4,"image":"mysql:latest","imageID":"docker-pullable://mysql@sha256:a7cf659a764732a27963429a87eccc8457e6d4af0ee9d5140a3b56e74986eed7","containerID":"docker://b65e01f413f2db5e3222b29b22bd995b36dd9a8084a9fc1ef9059461afdbd421"}],"qosClass":"BestEffort"}},"requestReceivedTimestamp":"2019-04-03T20:05:49.804913Z","stageTimestamp":"2019-04-03T20:05:49.814341Z","annotations":{"authorization.k8s.io/decision":"allow","authorization.k8s.io/reason":"RBAC: allowed by ClusterRoleBinding \"system:controller:generic-garbage-collector\" of ClusterRole \"system:controller:generic-garbage-collector\" to ServiceAccount \"generic-garbage-collector/kube-system\""},"name":"database-74656f569f-kjbhl"}},{"_index":"tigera_secure_ee_audit_kube.cluster.20190403","_type":"fluentd","_id":"v1fM5GkB5zWAjbhQRVXd","_score":0.9135168,"_source":{"kind":"Event","apiVersion":"audit.k8s.io/v1","level":"RequestResponse","auditID":"8d0aa866-44ef-485b-a5d0-09617d57b2d0","stage":"ResponseComplete","requestURI":"/api/v1/namespaces/compliance-testing/pods","verb":"create","user":{"username":"system:serviceaccount:kube-system:replicaset-controller","uid":"9e4a480e-54cb-11e9-8243-42010a800036","groups":["system:serviceaccounts","system:serviceaccounts:kube-system","system:authenticated"]},"sourceIPs":["10.128.0.54"],"userAgent":"kube-controller-manager/v1.13.4 (linux/amd64) kubernetes/c27b913/system:serviceaccount:kube-system:replicaset-controller","objectRef":{"resource":"pods","namespace":"compliance-testing","apiVersion":"v1"},"responseStatus":{"metadata":{},"code":201},"requestObject":{"kind":"Pod","apiVersion":"v1","metadata":{"generateName":"database-74656f569f-","creationTimestamp":null,"labels":{"app":"database","pod-template-hash":"74656f569f","version":"v2"},"ownerReferences":[{"apiVersion":"apps/v1","kind":"ReplicaSet","name":"database-74656f569f","uid":"7bd0c8c0-564b-11e9-8550-42010a800036","controller":true,"blockOwnerDeletion":true}]},"spec":{"containers":[{"name":"database","image":"mysql","ports":[{"containerPort":3307,"protocol":"TCP"}],"resources":{},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"Always"}],"restartPolicy":"Always","terminationGracePeriodSeconds":30,"dnsPolicy":"ClusterFirst","serviceAccountName":"database","serviceAccount":"database","securityContext":{},"schedulerName":"default-scheduler","enableServiceLinks":true},"status":{}},"responseObject":{"kind":"Pod","apiVersion":"v1","metadata":{"name":"database-74656f569f-kjbhl","generateName":"database-74656f569f-","namespace":"compliance-testing","selfLink":"/api/v1/namespaces/compliance-testing/pods/database-74656f569f-kjbhl","uid":"7bd389e8-564b-11e9-8550-42010a800036","resourceVersion":"239432","creationTimestamp":"2019-04-03T20:03:01Z","labels":{"app":"database","pod-template-hash":"74656f569f","version":"v2"},"ownerReferences":[{"apiVersion":"apps/v1","kind":"ReplicaSet","name":"database-74656f569f","uid":"7bd0c8c0-564b-11e9-8550-42010a800036","controller":true,"blockOwnerDeletion":true}]},"spec":{"volumes":[{"name":"database-token-fsjbn","secret":{"secretName":"database-token-fsjbn","defaultMode":420}}],"containers":[{"name":"database","image":"mysql","ports":[{"containerPort":3307,"protocol":"TCP"}],"resources":{},"volumeMounts":[{"name":"database-token-fsjbn","readOnly":true,"mountPath":"/var/run/secrets/kubernetes.io/serviceaccount"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"Always"}],"restartPolicy":"Always","terminationGracePeriodSeconds":30,"dnsPolicy":"ClusterFirst","serviceAccountName":"database","serviceAccount":"database","securityContext":{},"schedulerName":"default-scheduler","tolerations":[{"key":"node.kubernetes.io/not-ready","operator":"Exists","effect":"NoExecute","tolerationSeconds":300},{"key":"node.kubernetes.io/unreachable","operator":"Exists","effect":"NoExecute","tolerationSeconds":300}],"priority":0,"enableServiceLinks":true},"status":{"phase":"Pending","qosClass":"BestEffort"}},"requestReceivedTimestamp":"2019-04-03T20:03:01.147769Z","stageTimestamp":"2019-04-03T20:03:01.154169Z","annotations":{"authorization.k8s.io/decision":"allow","authorization.k8s.io/reason":"RBAC: allowed by ClusterRoleBinding \"system:controller:replicaset-controller\" of ClusterRole \"system:controller:replicaset-controller\" to ServiceAccount \"replicaset-controller/kube-system\""},"name":"database-74656f569f-kjbhl"}},{"_index":"tigera_secure_ee_audit_kube.cluster.20190403","_type":"fluentd","_id":"wVfM5GkB5zWAjbhQRVXd","_score":0.9135168,"_source":{"kind":"Event","apiVersion":"audit.k8s.io/v1","level":"RequestResponse","auditID":"cfde12e6-040f-4246-a201-1ad469e3ecbb","stage":"ResponseComplete","requestURI":"/api/v1/namespaces/compliance-testing/pods","verb":"create","user":{"username":"system:serviceaccount:kube-system:replicaset-controller","uid":"9e4a480e-54cb-11e9-8243-42010a800036","groups":["system:serviceaccounts","system:serviceaccounts:kube-system","system:authenticated"]},"sourceIPs":["10.128.0.54"],"userAgent":"kube-controller-manager/v1.13.4 (linux/amd64) kubernetes/c27b913/system:serviceaccount:kube-system:replicaset-controller","objectRef":{"resource":"pods","namespace":"compliance-testing","apiVersion":"v1"},"responseStatus":{"metadata":{},"code":201},"requestObject":{"kind":"Pod","apiVersion":"v1","metadata":{"generateName":"database-74656f569f-","creationTimestamp":null,"labels":{"app":"database","pod-template-hash":"74656f569f","version":"v2"},"ownerReferences":[{"apiVersion":"apps/v1","kind":"ReplicaSet","name":"database-74656f569f","uid":"7bd0c8c0-564b-11e9-8550-42010a800036","controller":true,"blockOwnerDeletion":true}]},"spec":{"containers":[{"name":"database","image":"mysql","ports":[{"containerPort":3307,"protocol":"TCP"}],"resources":{},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"Always"}],"restartPolicy":"Always","terminationGracePeriodSeconds":30,"dnsPolicy":"ClusterFirst","serviceAccountName":"database","serviceAccount":"database","securityContext":{},"schedulerName":"default-scheduler","enableServiceLinks":true},"status":{}},"responseObject":{"kind":"Pod","apiVersion":"v1","metadata":{"name":"database-74656f569f-6cvcb","generateName":"database-74656f569f-","namespace":"compliance-testing","selfLink":"/api/v1/namespaces/compliance-testing/pods/database-74656f569f-6cvcb","uid":"7d29f50e-564b-11e9-8550-42010a800036","resourceVersion":"239467","creationTimestamp":"2019-04-03T20:03:03Z","labels":{"app":"database","pod-template-hash":"74656f569f","version":"v2"},"ownerReferences":[{"apiVersion":"apps/v1","kind":"ReplicaSet","name":"database-74656f569f","uid":"7bd0c8c0-564b-11e9-8550-42010a800036","controller":true,"blockOwnerDeletion":true}]},"spec":{"volumes":[{"name":"database-token-fsjbn","secret":{"secretName":"database-token-fsjbn","defaultMode":420}}],"containers":[{"name":"database","image":"mysql","ports":[{"containerPort":3307,"protocol":"TCP"}],"resources":{},"volumeMounts":[{"name":"database-token-fsjbn","readOnly":true,"mountPath":"/var/run/secrets/kubernetes.io/serviceaccount"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"Always"}],"restartPolicy":"Always","terminationGracePeriodSeconds":30,"dnsPolicy":"ClusterFirst","serviceAccountName":"database","serviceAccount":"database","securityContext":{},"schedulerName":"default-scheduler","tolerations":[{"key":"node.kubernetes.io/not-ready","operator":"Exists","effect":"NoExecute","tolerationSeconds":300},{"key":"node.kubernetes.io/unreachable","operator":"Exists","effect":"NoExecute","tolerationSeconds":300}],"priority":0,"enableServiceLinks":true},"status":{"phase":"Pending","qosClass":"BestEffort"}},"requestReceivedTimestamp":"2019-04-03T20:03:03.394267Z","stageTimestamp":"2019-04-03T20:03:03.406525Z","annotations":{"authorization.k8s.io/decision":"allow","authorization.k8s.io/reason":"RBAC: allowed by ClusterRoleBinding \"system:controller:replicaset-controller\" of ClusterRole \"system:controller:replicaset-controller\" to ServiceAccount \"replicaset-controller/kube-system\""},"name":"database-74656f569f-6cvcb"}},{"_index":"tigera_secure_ee_audit_kube.cluster.20190403","_type":"fluentd","_id":"rlfK5GkB5zWAjbhQ81Vn","_score":0.9135168,"_source":{"kind":"Event","apiVersion":"audit.k8s.io/v1","level":"RequestResponse","auditID":"dbdc05de-a0b5-4c0c-9522-4e80e4e5a6bd","stage":"ResponseComplete","requestURI":"/api/v1/namespaces/compliance-testing/services","verb":"create","user":{"username":"kubernetes-admin","groups":["system:masters","system:authenticated"]},"sourceIPs":["199.116.73.11"],"userAgent":"kubectl/v1.13.4 (darwin/amd64) kubernetes/c27b913","objectRef":{"resource":"services","namespace":"compliance-testing","name":"database","apiVersion":"v1"},"responseStatus":{"metadata":{},"code":201},"requestObject":{"kind":"Service","apiVersion":"v1","metadata":{"name":"database","namespace":"compliance-testing","creationTimestamp":null,"labels":{"app":"database"},"annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"v1\",\"kind\":\"Service\",\"metadata\":{\"annotations\":{},\"labels\":{\"app\":\"database\"},\"name\":\"database\",\"namespace\":\"compliance-testing\"},\"spec\":{\"ports\":[{\"name\":\"mysql\",\"port\":3306}],\"selector\":{\"app\":\"database\"}}}\n"}},"spec":{"ports":[{"name":"mysql","protocol":"TCP","port":3306,"targetPort":3306}],"selector":{"app":"database"},"type":"ClusterIP","sessionAffinity":"None"},"status":{"loadBalancer":{}}},"responseObject":{"kind":"Service","apiVersion":"v1","metadata":{"name":"database","namespace":"compliance-testing","selfLink":"/api/v1/namespaces/compliance-testing/services/database","uid":"4934dfad-564b-11e9-8550-42010a800036","resourceVersion":"239257","creationTimestamp":"2019-04-03T20:01:36Z","labels":{"app":"database"},"annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"v1\",\"kind\":\"Service\",\"metadata\":{\"annotations\":{},\"labels\":{\"app\":\"database\"},\"name\":\"database\",\"namespace\":\"compliance-testing\"},\"spec\":{\"ports\":[{\"name\":\"mysql\",\"port\":3306}],\"selector\":{\"app\":\"database\"}}}\n"}},"spec":{"ports":[{"name":"mysql","protocol":"TCP","port":3306,"targetPort":3306}],"selector":{"app":"database"},"clusterIP":"10.109.212.44","type":"ClusterIP","sessionAffinity":"None"},"status":{"loadBalancer":{}}},"requestReceivedTimestamp":"2019-04-03T20:01:36.218581Z","stageTimestamp":"2019-04-03T20:01:36.231312Z","annotations":{"authorization.k8s.io/decision":"allow","authorization.k8s.io/reason":""},"name":"database"}},{"_index":"tigera_secure_ee_audit_kube.cluster.20190403","_type":"fluentd","_id":"p1fK5GkB5zWAjbhQqFUh","_score":0.9135168,"_source":{"kind":"Event","apiVersion":"audit.k8s.io/v1","level":"RequestResponse","auditID":"8632073c-ea5f-43d8-9e42-229d61e5ae0a","stage":"ResponseComplete","requestURI":"/api/v1/namespaces/compliance-testing/serviceaccounts/database","verb":"update","user":{"username":"system:kube-controller-manager","groups":["system:authenticated"]},"sourceIPs":["10.128.0.54"],"userAgent":"kube-controller-manager/v1.13.4 (linux/amd64) kubernetes/c27b913/tokens-controller","objectRef":{"resource":"serviceaccounts","namespace":"compliance-testing","name":"database","uid":"3ca6c1fe-564b-11e9-8550-42010a800036","apiVersion":"v1","resourceVersion":"239164"},"responseStatus":{"metadata":{},"code":200},"requestObject":{"kind":"ServiceAccount","apiVersion":"v1","metadata":{"name":"database","namespace":"compliance-testing","selfLink":"/api/v1/namespaces/compliance-testing/serviceaccounts/database","uid":"3ca6c1fe-564b-11e9-8550-42010a800036","resourceVersion":"239164","creationTimestamp":"2019-04-03T20:01:15Z","labels":{"app":"database"},"annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"v1\",\"kind\":\"ServiceAccount\",\"metadata\":{\"annotations\":{},\"labels\":{\"app\":\"database\"},\"name\":\"database\",\"namespace\":\"compliance-testing\"}}\n"}},"secrets":[{"name":"database-token-fsjbn"}]},"responseObject":{"kind":"ServiceAccount","apiVersion":"v1","metadata":{"name":"database","namespace":"compliance-testing","selfLink":"/api/v1/namespaces/compliance-testing/serviceaccounts/database","uid":"3ca6c1fe-564b-11e9-8550-42010a800036","resourceVersion":"239166","creationTimestamp":"2019-04-03T20:01:15Z","labels":{"app":"database"},"annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"v1\",\"kind\":\"ServiceAccount\",\"metadata\":{\"annotations\":{},\"labels\":{\"app\":\"database\"},\"name\":\"database\",\"namespace\":\"compliance-testing\"}}\n"}},"secrets":[{"name":"database-token-fsjbn"}]},"requestReceivedTimestamp":"2019-04-03T20:01:15.174216Z","stageTimestamp":"2019-04-03T20:01:15.176541Z","annotations":{"authorization.k8s.io/decision":"allow","authorization.k8s.io/reason":"RBAC: allowed by ClusterRoleBinding \"system:kube-controller-manager\" of ClusterRole \"system:kube-controller-manager\" to User \"system:kube-controller-manager\""},"name":"database"}},{"_index":"tigera_secure_ee_audit_kube.cluster.20190403","_type":"fluentd","_id":"xFfM5GkB5zWAjbhQcVWC","_score":0.9135168,"_source":{"kind":"Event","apiVersion":"audit.k8s.io/v1","level":"RequestResponse","auditID":"394a149f-beb4-423f-b1dd-3c198aa93bf1","stage":"ResponseComplete","requestURI":"/api/v1/namespaces/compliance-testing/services/database","verb":"patch","user":{"username":"kubernetes-admin","groups":["system:masters","system:authenticated"]},"sourceIPs":["199.116.73.11"],"userAgent":"kubectl/v1.13.4 (darwin/amd64) kubernetes/c27b913","objectRef":{"resource":"services","namespace":"compliance-testing","name":"database","apiVersion":"v1"},"responseStatus":{"metadata":{},"code":200},"requestObject":{"metadata":{"annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"v1\",\"kind\":\"Service\",\"metadata\":{\"annotations\":{},\"labels\":{\"app\":\"database\"},\"name\":\"database\",\"namespace\":\"compliance-testing\"},\"spec\":{\"ports\":[{\"name\":\"mysqls\",\"port\":3307}],\"selector\":{\"app\":\"database\"}}}\n"}},"spec":{"$setElementOrder/ports":[{"port":3307}],"ports":[{"name":"mysqls","port":3307},{"$patch":"delete","port":3306}]}},"responseObject":{"kind":"Service","apiVersion":"v1","metadata":{"name":"database","namespace":"compliance-testing","selfLink":"/api/v1/namespaces/compliance-testing/services/database","uid":"4934dfad-564b-11e9-8550-42010a800036","resourceVersion":"239536","creationTimestamp":"2019-04-03T20:01:36Z","labels":{"app":"database"},"annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"v1\",\"kind\":\"Service\",\"metadata\":{\"annotations\":{},\"labels\":{\"app\":\"database\"},\"name\":\"database\",\"namespace\":\"compliance-testing\"},\"spec\":{\"ports\":[{\"name\":\"mysqls\",\"port\":3307}],\"selector\":{\"app\":\"database\"}}}\n"}},"spec":{"ports":[{"name":"mysqls","protocol":"TCP","port":3307,"targetPort":3307}],"selector":{"app":"database"},"clusterIP":"10.109.212.44","type":"ClusterIP","sessionAffinity":"None"},"status":{"loadBalancer":{}}},"requestReceivedTimestamp":"2019-04-03T20:03:11.514463Z","stageTimestamp":"2019-04-03T20:03:11.518864Z","annotations":{"authorization.k8s.io/decision":"allow","authorization.k8s.io/reason":""},"name":"database"}},{"_index":"tigera_secure_ee_audit_kube.cluster.20190403","_type":"fluentd","_id":"7VfP5GkB5zWAjbhQLFUN","_score":0.9135168,"_source":{"kind":"Event","apiVersion":"audit.k8s.io/v1","level":"RequestResponse","auditID":"19fed828-9937-4f0c-b498-dd447de46573","stage":"ResponseComplete","requestURI":"/api/v1/namespaces/compliance-testing","verb":"delete","user":{"username":"kubernetes-admin","groups":["system:masters","system:authenticated"]},"sourceIPs":["199.116.73.11"],"userAgent":"kubectl/v1.13.4 (darwin/amd64) kubernetes/c27b913","objectRef":{"resource":"namespaces","namespace":"compliance-testing","name":"compliance-testing","apiVersion":"v1"},"responseStatus":{"metadata":{},"code":200},"requestObject":{"kind":"DeleteOptions","apiVersion":"v1","propagationPolicy":"Background"},"responseObject":{"kind":"Namespace","apiVersion":"v1","metadata":{"name":"compliance-testing","selfLink":"/api/v1/namespaces/compliance-testing","uid":"3650e282-564b-11e9-8550-42010a800036","resourceVersion":"239870","creationTimestamp":"2019-04-03T20:01:04Z","deletionTimestamp":"2019-04-03T20:06:10Z"},"spec":{"finalizers":["kubernetes"]},"status":{"phase":"Terminating"}},"requestReceivedTimestamp":"2019-04-03T20:06:10.388065Z","stageTimestamp":"2019-04-03T20:06:10.392208Z","annotations":{"authorization.k8s.io/decision":"allow","authorization.k8s.io/reason":""},"name":"compliance-testing"}},{"_index":"tigera_secure_ee_audit_kube.cluster.20190403","_type":"fluentd","_id":"pFfK5GkB5zWAjbhQfFVz","_score":0.14821595,"_source":{"kind":"Event","apiVersion":"audit.k8s.io/v1","level":"RequestResponse","auditID":"6e961fcb-0498-40ed-9256-facfea318fb4","stage":"ResponseComplete","requestURI":"/api/v1/namespaces/compliance-testing/serviceaccounts","verb":"create","user":{"username":"system:serviceaccount:kube-system:service-account-controller","uid":"9f8315a0-54cb-11e9-8243-42010a800036","groups":["system:serviceaccounts","system:serviceaccounts:kube-system","system:authenticated"]},"sourceIPs":["10.128.0.54"],"userAgent":"kube-controller-manager/v1.13.4 (linux/amd64) kubernetes/c27b913/system:serviceaccount:kube-system:service-account-controller","objectRef":{"resource":"serviceaccounts","namespace":"compliance-testing","name":"default","apiVersion":"v1"},"responseStatus":{"metadata":{},"code":201},"requestObject":{"kind":"ServiceAccount","apiVersion":"v1","metadata":{"name":"default","namespace":"compliance-testing","creationTimestamp":null}},"responseObject":{"kind":"ServiceAccount","apiVersion":"v1","metadata":{"name":"default","namespace":"compliance-testing","selfLink":"/api/v1/namespaces/compliance-testing/serviceaccounts/default","uid":"36529b95-564b-11e9-8550-42010a800036","resourceVersion":"239145","creationTimestamp":"2019-04-03T20:01:04Z"}},"requestReceivedTimestamp":"2019-04-03T20:01:04.542599Z","stageTimestamp":"2019-04-03T20:01:04.548357Z","annotations":{"authorization.k8s.io/decision":"allow","authorization.k8s.io/reason":"RBAC: allowed by ClusterRoleBinding \"system:controller:service-account-controller\" of ClusterRole \"system:controller:service-account-controller\" to ServiceAccount \"service-account-controller/kube-system\""},"name":"default"}},{"_index":"tigera_secure_ee_audit_kube.cluster.20190403","_type":"fluentd","_id":"plfK5GkB5zWAjbhQqFUh","_score":0.14821595,"_source":{"kind":"Event","apiVersion":"audit.k8s.io/v1","level":"RequestResponse","auditID":"5ca5329a-0b67-463b-8b36-9b4d1a465efe","stage":"ResponseComplete","requestURI":"/api/v1/namespaces/compliance-testing/serviceaccounts","verb":"create","user":{"username":"kubernetes-admin","groups":["system:masters","system:authenticated"]},"sourceIPs":["199.116.73.11"],"userAgent":"kubectl/v1.13.4 (darwin/amd64) kubernetes/c27b913","objectRef":{"resource":"serviceaccounts","namespace":"compliance-testing","name":"database","apiVersion":"v1"},"responseStatus":{"metadata":{},"code":201},"requestObject":{"kind":"ServiceAccount","apiVersion":"v1","metadata":{"name":"database","namespace":"compliance-testing","creationTimestamp":null,"labels":{"app":"database"},"annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"v1\",\"kind\":\"ServiceAccount\",\"metadata\":{\"annotations\":{},\"labels\":{\"app\":\"database\"},\"name\":\"database\",\"namespace\":\"compliance-testing\"}}\n"}}},"responseObject":{"kind":"ServiceAccount","apiVersion":"v1","metadata":{"name":"database","namespace":"compliance-testing","selfLink":"/api/v1/namespaces/compliance-testing/serviceaccounts/database","uid":"3ca6c1fe-564b-11e9-8550-42010a800036","resourceVersion":"239164","creationTimestamp":"2019-04-03T20:01:15Z","labels":{"app":"database"},"annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"v1\",\"kind\":\"ServiceAccount\",\"metadata\":{\"annotations\":{},\"labels\":{\"app\":\"database\"},\"name\":\"database\",\"namespace\":\"compliance-testing\"}}\n"}}},"requestReceivedTimestamp":"2019-04-03T20:01:15.160339Z","stageTimestamp":"2019-04-03T20:01:15.163478Z","annotations":{"authorization.k8s.io/decision":"allow","authorization.k8s.io/reason":""},"name":"database"}},{"_index":"tigera_secure_ee_audit_kube.cluster.20190403","_type":"fluentd","_id":"vlfM5GkB5zWAjbhQIVUH","_score":0.14821595,"_source":{"kind":"Event","apiVersion":"audit.k8s.io/v1","level":"RequestResponse","auditID":"738c5c7f-e48b-40ac-b850-a1c4b2b18fa2","stage":"ResponseComplete","requestURI":"/api/v1/namespaces/compliance-testing/serviceaccounts/database","verb":"patch","user":{"username":"kubernetes-admin","groups":["system:masters","system:authenticated"]},"sourceIPs":["199.116.73.11"],"userAgent":"kubectl/v1.13.4 (darwin/amd64) kubernetes/c27b913","objectRef":{"resource":"serviceaccounts","namespace":"compliance-testing","name":"database","apiVersion":"v1"},"responseStatus":{"metadata":{},"code":200},"requestObject":{"metadata":{"annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"v1\",\"kind\":\"ServiceAccount\",\"metadata\":{\"annotations\":{},\"labels\":{\"app\":\"database\",\"foo\":\"bar\"},\"name\":\"database\",\"namespace\":\"compliance-testing\"}}\n"},"labels":{"foo":"bar"}}},"responseObject":{"kind":"ServiceAccount","apiVersion":"v1","metadata":{"name":"database","namespace":"compliance-testing","selfLink":"/api/v1/namespaces/compliance-testing/serviceaccounts/database","uid":"3ca6c1fe-564b-11e9-8550-42010a800036","resourceVersion":"239411","creationTimestamp":"2019-04-03T20:01:15Z","labels":{"app":"database","foo":"bar"},"annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"v1\",\"kind\":\"ServiceAccount\",\"metadata\":{\"annotations\":{},\"labels\":{\"app\":\"database\",\"foo\":\"bar\"},\"name\":\"database\",\"namespace\":\"compliance-testing\"}}\n"}},"secrets":[{"name":"database-token-fsjbn"}]},"requestReceivedTimestamp":"2019-04-03T20:02:50.709454Z","stageTimestamp":"2019-04-03T20:02:50.712170Z","annotations":{"authorization.k8s.io/decision":"allow","authorization.k8s.io/reason":""},"name":"database"}},{"_index":"tigera_secure_ee_audit_kube.cluster.20190403","_type":"fluentd","_id":"wFfM5GkB5zWAjbhQRVXd","_score":0.14821595,"_source":{"kind":"Event","apiVersion":"audit.k8s.io/v1","level":"RequestResponse","auditID":"29f85634-d688-4bdc-9fcb-36961428a4f3","stage":"ResponseComplete","requestURI":"/api/v1/namespaces/compliance-testing/pods/database-f5c74785f-qnvpt","verb":"delete","user":{"username":"system:serviceaccount:kube-system:replicaset-controller","uid":"9e4a480e-54cb-11e9-8243-42010a800036","groups":["system:serviceaccounts","system:serviceaccounts:kube-system","system:authenticated"]},"sourceIPs":["10.128.0.54"],"userAgent":"kube-controller-manager/v1.13.4 (linux/amd64) kubernetes/c27b913/system:serviceaccount:kube-system:replicaset-controller","objectRef":{"resource":"pods","namespace":"compliance-testing","name":"database-f5c74785f-qnvpt","apiVersion":"v1"},"responseStatus":{"metadata":{},"code":200},"responseObject":{"kind":"Pod","apiVersion":"v1","metadata":{"name":"database-f5c74785f-qnvpt","generateName":"database-f5c74785f-","namespace":"compliance-testing","selfLink":"/api/v1/namespaces/compliance-testing/pods/database-f5c74785f-qnvpt","uid":"42f8e905-564b-11e9-8550-42010a800036","resourceVersion":"239461","creationTimestamp":"2019-04-03T20:01:25Z","deletionTimestamp":"2019-04-03T20:03:33Z","deletionGracePeriodSeconds":30,"labels":{"app":"database","pod-template-hash":"f5c74785f","version":"v1"},"ownerReferences":[{"apiVersion":"apps/v1","kind":"ReplicaSet","name":"database-f5c74785f","uid":"42f7023b-564b-11e9-8550-42010a800036","controller":true,"blockOwnerDeletion":true}]},"spec":{"volumes":[{"name":"database-token-fsjbn","secret":{"secretName":"database-token-fsjbn","defaultMode":420}}],"containers":[{"name":"database","image":"mysql","ports":[{"containerPort":3306,"protocol":"TCP"}],"resources":{},"volumeMounts":[{"name":"database-token-fsjbn","readOnly":true,"mountPath":"/var/run/secrets/kubernetes.io/serviceaccount"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"Always"}],"restartPolicy":"Always","terminationGracePeriodSeconds":30,"dnsPolicy":"ClusterFirst","serviceAccountName":"database","serviceAccount":"database","nodeName":"bkim-kadm-node-0","securityContext":{},"schedulerName":"default-scheduler","tolerations":[{"key":"node.kubernetes.io/not-ready","operator":"Exists","effect":"NoExecute","tolerationSeconds":300},{"key":"node.kubernetes.io/unreachable","operator":"Exists","effect":"NoExecute","tolerationSeconds":300}],"priority":0,"enableServiceLinks":true},"status":{"phase":"Running","conditions":[{"type":"Initialized","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-04-03T20:01:25Z"},{"type":"Ready","status":"False","lastProbeTime":null,"lastTransitionTime":"2019-04-03T20:01:47Z","reason":"ContainersNotReady","message":"containers with unready status: [database]"},{"type":"ContainersReady","status":"False","lastProbeTime":null,"lastTransitionTime":"2019-04-03T20:01:47Z","reason":"ContainersNotReady","message":"containers with unready status: [database]"},{"type":"PodScheduled","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-04-03T20:01:25Z"}],"hostIP":"10.128.0.138","podIP":"192.168.166.78","startTime":"2019-04-03T20:01:25Z","containerStatuses":[{"name":"database","state":{"waiting":{"reason":"CrashLoopBackOff","message":"Back-off 40s restarting failed container=database pod=database-f5c74785f-qnvpt_compliance-testing(42f8e905-564b-11e9-8550-42010a800036)"}},"lastState":{"terminated":{"exitCode":1,"reason":"Error","startedAt":"2019-04-03T20:02:18Z","finishedAt":"2019-04-03T20:02:18Z","containerID":"docker://8f594fc97b8d98725ae63cd2c337685d719a0b429fd3c1407e529717feae763b"}},"ready":false,"restartCount":3,"image":"mysql:latest","imageID":"docker-pullable://mysql@sha256:a7cf659a764732a27963429a87eccc8457e6d4af0ee9d5140a3b56e74986eed7","containerID":"docker://8f594fc97b8d98725ae63cd2c337685d719a0b429fd3c1407e529717feae763b"}],"qosClass":"BestEffort"}},"requestReceivedTimestamp":"2019-04-03T20:03:03.351080Z","stageTimestamp":"2019-04-03T20:03:03.368237Z","annotations":{"authorization.k8s.io/decision":"allow","authorization.k8s.io/reason":"RBAC: allowed by ClusterRoleBinding \"system:controller:replicaset-controller\" of ClusterRole \"system:controller:replicaset-controller\" to ServiceAccount \"replicaset-controller/kube-system\""},"name":"database-f5c74785f-qnvpt"}},{"_index":"tigera_secure_ee_audit_kube.cluster.20190403","_type":"fluentd","_id":"11fN5GkB5zWAjbhQk1XF","_score":0.14821595,"_source":{"kind":"Event","apiVersion":"audit.k8s.io/v1","level":"RequestResponse","auditID":"3cb540a0-a9a9-40cf-9cfa-4586db2e703f","stage":"ResponseComplete","requestURI":"/apis/extensions/v1beta1/namespaces/compliance-testing/networkpolicies/default-deny","verb":"patch","user":{"username":"kubernetes-admin","groups":["system:masters","system:authenticated"]},"sourceIPs":["199.116.73.11"],"userAgent":"kubectl/v1.13.4 (darwin/amd64) kubernetes/c27b913","objectRef":{"resource":"networkpolicies","namespace":"compliance-testing","name":"default-deny","apiGroup":"extensions","apiVersion":"v1beta1"},"responseStatus":{"metadata":{},"code":200},"requestObject":{"spec":{"podSelector":{"matchLabels":{}}}},"responseObject":{"kind":"NetworkPolicy","apiVersion":"extensions/v1beta1","metadata":{"name":"default-deny","namespace":"compliance-testing","selfLink":"/apis/extensions/v1beta1/namespaces/compliance-testing/networkpolicies/default-deny","uid":"4f794df8-564b-11e9-8550-42010a800036","resourceVersion":"239693","generation":3,"creationTimestamp":"2019-04-03T20:01:46Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"networking.k8s.io/v1\",\"kind\":\"NetworkPolicy\",\"metadata\":{\"annotations\":{},\"name\":\"default-deny\",\"namespace\":\"compliance-testing\"},\"spec\":{\"podSelector\":{\"matchLabels\":{\"app\":\"summary\"}}}}\n"}},"spec":{"podSelector":{"matchLabels":{"app":"summary"}},"policyTypes":["Ingress"]}},"requestReceivedTimestamp":"2019-04-03T20:04:26.067248Z","stageTimestamp":"2019-04-03T20:04:26.071857Z","annotations":{"authorization.k8s.io/decision":"allow","authorization.k8s.io/reason":""},"name":"default-deny"}},{"_index":"tigera_secure_ee_audit_kube.cluster.20190403","_type":"fluentd","_id":"71fP5GkB5zWAjbhQP1XF","_score":0.14821595,"_source":{"kind":"Event","apiVersion":"audit.k8s.io/v1","level":"RequestResponse","auditID":"76bf45f7-44a3-4b82-876a-52ad19cbfac6","stage":"ResponseComplete","requestURI":"/api/v1/namespaces/compliance-testing","verb":"delete","user":{"username":"system:serviceaccount:kube-system:namespace-controller","uid":"9ed39472-54cb-11e9-8243-42010a800036","groups":["system:serviceaccounts","system:serviceaccounts:kube-system","system:authenticated"]},"sourceIPs":["10.128.0.54"],"userAgent":"kube-controller-manager/v1.13.4 (linux/amd64) kubernetes/c27b913/system:serviceaccount:kube-system:namespace-controller","objectRef":{"resource":"namespaces","namespace":"compliance-testing","name":"compliance-testing","apiVersion":"v1"},"responseStatus":{"metadata":{},"code":200},"requestObject":{"kind":"DeleteOptions","apiVersion":"v1","preconditions":{"uid":"3650e282-564b-11e9-8550-42010a800036"}},"responseObject":{"kind":"Namespace","apiVersion":"v1","metadata":{"name":"compliance-testing","selfLink":"/api/v1/namespaces/compliance-testing","uid":"3650e282-564b-11e9-8550-42010a800036","resourceVersion":"239915","creationTimestamp":"2019-04-03T20:01:04Z","deletionTimestamp":"2019-04-03T20:06:10Z"},"spec":{},"status":{"phase":"Terminating"}},"requestReceivedTimestamp":"2019-04-03T20:06:15.710816Z","stageTimestamp":"2019-04-03T20:06:15.714936Z","annotations":{"authorization.k8s.io/decision":"allow","authorization.k8s.io/reason":"RBAC: allowed by ClusterRoleBinding \"system:controller:namespace-controller\" of ClusterRole \"system:controller:namespace-controller\" to ServiceAccount \"namespace-controller/kube-system\""},"name":"compliance-testing"}},{"_index":"tigera_secure_ee_audit_ee.cluster.20190507","_type":"fluentd","_id":"fgSXkGoBxB1mk6MND1lZ","_score":1.3862944,"_source":{"kind":"Event","apiVersion":"audit.k8s.io/v1beta1","metadata":{"creationTimestamp":"2019-05-07T04:39:34Z"},"level":"RequestResponse","timestamp":"2019-05-07T04:39:34Z","auditID":"62d4a78d-1067-42b6-9c70-a4aaf6cf2cbc","stage":"ResponseComplete","requestURI":"/apis/projectcalico.org/v3/globalnetworkpolicies/test.allow-egress-to-domains","verb":"update","user":{"username":"jane","groups":["system:authenticated"]},"sourceIPs":["10.128.0.12"],"objectRef":{"resource":"globalnetworkpolicies","name":"test.allow-egress-to-domains","uid":"c9534716-7081-11e9-8d6c-42010a80007d","apiGroup":"projectcalico.org","apiVersion":"v3","resourceVersion":"74616"},"responseStatus":{"kind":"Status","apiVersion":"v1","metadata":{},"status":"Failure","message":" \"test.allow-egress-to-domains\" is invalid: Destination.Selector: Invalid value: \"null\": must be left empty when Destination.Domains is specified","reason":"Invalid","details":{"name":"test.allow-egress-to-domains","causes":[{"reason":"FieldValueInvalid","message":"Invalid value: \"null\": must be left empty when Destination.Domains is specified","field":"Destination.Selector"}]},"code":422},"requestObject":{"kind":"GlobalNetworkPolicy","apiVersion":"projectcalico.org/v3","metadata":{"name":"test.allow-egress-to-domains","uid":"c9534716-7081-11e9-8d6c-42010a80007d","resourceVersion":"74616","creationTimestamp":null},"spec":{"tier":"test","order":100,"egress":[{"action":"Allow","source":{},"destination":{"selector":"my-pod-label == \"my-value\"","domains":["api.alice.com","bob.example.com"]}}],"selector":"my-pod-label == \"my-value\"","types":["Egress"]}},"responseObject":{"kind":"Status","apiVersion":"v1","metadata":{},"status":"Failure","message":" \"test.allow-egress-to-domains\" is invalid: Destination.Selector: Invalid value: \"null\": must be left empty when Destination.Domains is specified","reason":"Invalid","details":{"name":"test.allow-egress-to-domains","causes":[{"reason":"FieldValueInvalid","message":"Invalid value: \"null\": must be left empty when Destination.Domains is specified","field":"Destination.Selector"}]},"code":422},"requestReceivedTimestamp":"2019-05-07T04:39:34.945734Z","stageTimestamp":"2019-05-07T04:39:34.953272Z","name":null}}]}}`
