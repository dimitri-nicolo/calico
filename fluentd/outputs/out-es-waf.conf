  <store>
    @type elasticsearch
    host "#{ENV['ELASTIC_HOST']}"
    port "#{ENV['ELASTIC_PORT']}"
    scheme "https"
    user "#{ENV['ELASTIC_USER']}"
    password "#{ENV['ELASTIC_PASSWORD']}"
    ca_file "#{ENV['ROOT_DIR']}/etc/fluentd/elastic/ca.pem"
    ssl_verify "#{ENV['ELASTIC_SSL_VERIFY']}"
    ssl_version TLSv1_3
    reload_connections false
    reload_on_failure false
    reconnect_on_error true
    index_name "tigera_secure_ee_waf.#{ENV['ELASTIC_INDEX_SUFFIX']}."
    index_date_pattern "now/s{yyyyMMdd}"
    enable_ilm true
    ilm_policy_id "tigera_secure_ee_waf_policy"
    index_separator ""
    application_name "fluentd"
    template_file "#{ENV['ROOT_DIR']}/fluentd/etc/elastic_mapping_waf.template"
    template_name tigera_secure_ee_waf
    template_overwrite "#{ENV['ELASTIC_TEMPLATE_OVERWRITE']}"
    <buffer tag, time>
      timekey 1d
      flush_mode interval
      flush_interval "#{ENV['ELASTIC_FLUSH_INTERVAL']}"
      flush_thread_count 4
    </buffer>
  </store>
